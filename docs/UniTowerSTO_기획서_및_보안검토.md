# UniTower 프로젝트 STO 기획서 및 스마트 컨트랙트 보안 검토

---

## 1. 기획서 전문

- **회사명:** 유니닷컴
- **작성자명:** 김윤희
- **명칭:** UniTower 프로젝트 STO
- **모집가액:** 3,000,000,000원
- **단위당 모집가액:** 1,000,000원
- **주식의 수량:** 3,000주
- **청약기일:** 2025년 8월 1일 ~ 2025년 8월 10일
- **납입기일:** 2025년 8월 12일
- **청약공고일:** 2025년 7월 25일
- **배정공고일:** 2025년 8월 13일
- **예상 사업내용:** 성동구 성수동에 오피스텔 ‘유니타워’ 건립 및 분양 수익 실현 목적의 부동산 개발 사업

### 공동 사업의 내용
- 부동산 개발 전문 업체 ABC건설과 공동 시공
- 설계 및 인허가 절차는 DEF건축사 사무소와 협업
- 운영 수익의 70%는 투자자 배당, 30%는 회사 운영자금으로 재투자
- 스마트 컨트랙트를 기반 임대수익 자동 분배 시스템 구축 예정
- 공동 사업자별로 각자 업무 분담에 따라 ABC건설은 시공/준공 책임, DEF건축은 설계 및 인허가 완료 책임, 유니닷컴은 자금 관리 및 투자자 커뮤니케이션 책임을 짐

### 권리 내용
- 투자자는 매 분기 임대수익의 일정 비율을 정산하여 지급받음
- 2년 이후 프로젝트 매각 시, 자산 처분 수익에 대한 우선 배당 권리 보유
- STO 토큰은 양도 가능하며, 내부 P2P 마켓플레이스를 통한 거래 지원 예정
- 투자자는 정기적으로 의결권을 행사할 수 있으며, 프로젝트 관련 중요 안건에 대한 DAO 투표 참여권을 가짐
- 투자자는 DAO 참여 시, DAO 운영규약 및 거버넌스 참여의 의무를 성실히 이해해야 하며, 불법적 행위 및 자산 투기 목적으로 토큰을 사용해서는 안 됨

### 기초자산의 주요 내용
- 서울 성동구 성수동 소재 370평 규모의 상업용 부지
- 감정가 기준 약 70억 원 수준
- 해당 부지 위에 지상 15층, 지하 2층 규모 오피스텔 건립 예정
- 2026년 하반기 준공 및 분양 목표
- 해당 부지는 사업 진행 중 화재·침수 등 재난에 대비해 손해보험에 가입되며, 자산은 외부 전문 보관·관리 업체를 통해 통제 관리됨
- 부동산 담보권 설정은 투자자 보호 목적에 따라 제3자 채권자보다 후순위가 아닌 동순위 또는 우선 변제권 확보 예정

### 내부통제 주요내용
- 회계 투명성 확보를 위해 외부 회계법인과 정기 감사 계약 체결
- 스마트 컨트랙트를 통해 자동 배당 및 기록 이력 투명화
- DAO 기반의 의사결정 기능 구축(제안→투표→집행)
- 이해상충 방지 및 공동사업자 위탁 관리 방안 공개 예정
- 발행인은 발행 지분 일부를 상시 시가까지 보유하며, 이해관계자 참여 시 사전 고지를 통해 투자자 보호 조치를 병행함
- 스마트컨트랙트 해킹, 물리적 재해, 경영진 리스크에 대비해 비상 대응 매뉴얼(BCP)과 멀티시그 예치금 제도를 DAO 운영에 포함함

### 청약 및 배정의 주요내용
- 청약 최소 단위: 1구좌(1,000,000원)
- 1인당 최대 50구좌까지 청약 가능
- 청약 초과 시 무작위 추첨 배정 방식
- 실명 인증 완료된 투자자만 청약 가능
- 모든 투자자에 대해 청약 전 투자적합성 테스트 및 숙려 기간을 제공하며, 일반 투자자에게 일정 비율 우선 배정됨
- 청약 마감 시점까지 미청약된 물량은 DAO 의결을 거쳐 차기 라운드 유동화, 내부 소각 또는 운영사 인수 방식으로 처리됨

### 투자자 권리 주요내용
- 실물자산 기반의 STO로써 실질적 권리 확보 가능
- 분기별 수익 정산 및 배당
- 프로젝트 종료 후 자산 처분 시 원금 우선 상환
- 투자자 DAO를 통한 주요 의사결정 참여권 부여
- 수수료 부과 기준, 프로젝트 리스크 공시, 자산 운영 내역 등은 분기마다 공시되며, 모든 의사결정 내역은 온체인에서 확인 가능함

### 수수료 체계 계획
- 플랫폼 이용 수수료: 분기 배당액의 1.5%
- DAO 운영 수수료: 연간 0.3% 이내(회계 감사 등 실비 기준)
- 모든 수수료는 공시 및 스마트컨트랙트에 반영되어 자동 차감 및 투명하게 확인 가능

### 정보공시 계획
- 정기 공시: 분기별 운영현황 및 수익 리포트(DAO 대시보드 및 이메일 발송)
- 중요사항 발생 시 즉시 공시: 스마트컨트랙트 변경, 부지 개발 계획 변경 등
- 투표기록 및 배당 내역은 온체인 이력으로 확인 가능
- 투자자 보호를 위해 자산 손실 발생 시 대응 계획, 대리인 위탁 내역 등도 별도 공시 항목으로 관리됨
- 공시되는 회계 정보 및 배당자료는 외부 감사보고서 또는 스마트컨트랙트 이벤트 로그를 기준으로 검증되며, 누구나 열람 가능한 형태로 저장됨

---

## 2. 스마트 컨트랙트 보안 취약점 검토 및 주석

### 검토 대상: contracts/UniTowerSTO.sol
- 명령어: 스마트 컨트랙트에 알려진 취약점중에서 이 코드가 보안취약점을 가지고 있는지 검토해줘. 그리고 보안관점에서 검토내용을 주석으로 표시해줘

#### ✅ 주요 보안 패턴 및 방어 코드
- 재진입 공격 방지: ReentrancyGuard 상속 및 nonReentrant 사용(배당 수령 등)
- 접근제어: Ownable 상속, onlyOwner, onlyEmergencyOperator 등 명확한 권한 분리
- 비상정지: emergencyPause, emergencyUnpause로 운영자에 의한 긴급 중단 가능
- 입력값 검증: 각종 require문으로 입력값, 기간, 한도, 주소 등 검증
- 0 address 방지: validAddress modifier로 운영자 변경 등에서 0 address 방지
- 상태변수 선변경 후 call: ETH 전송 시 상태변수 먼저 변경 후 call 사용
- 수수료율 상한: setFeeRates에서 최대치 제한
- 투표/배당/청약 등 주요 행위에 대한 이벤트 기록

#### ⚠️ 보안 관점에서 추가로 주의할 점 및 개선 제안
- emergencyOperator 권한 오남용: 비상정지 기능은 강력하므로 운영자 권한 관리에 각별히 주의 필요
- 배당금, 수수료 인출 시 call 사용: 상태변수 선변경 후 call로 재진입 방지, 그러나 call 실패 시 revert로 안전
- DAO 투표/제안 관련: 1인 1표가 아닌, 배정량만큼 투표권 부여(기획서와 일치). 투표 중복 방지 및 기간 체크 적절
- 배당금 분배: 배당 등록 후 isDistributed 플래그가 실제 분배 로직과 연동되는지 확인 필요(코드상 분배 플래그만 존재, 실제 분배 트리거는 외부에서 필요)
- isVerified 필드: 투자자 검증 로직이 코드상 구현되어 있지 않음(향후 KYC 등 필요시 추가 구현 필요)
- 청약/납입/배정 등 시점별 상태 전이: require로 시점 체크는 있으나, 상태 전이 플래그가 더 명확하면 좋음
- 이더 수령(Receive): receive() 함수로 ETH 수령 가능, 의도치 않은 입금 방지 위해 필요시 fallback 제한 고려

### 📄 스마트 컨트랙트 내 보안 검토 주석 예시

```solidity
// [보안] emergencyOperator 권한 오남용 주의 필요
modifier onlyEmergencyOperator() {
    require(msg.sender == emergencyOperator, "Not emergency operator");
    _;
}

// [보안] 비상정지 상태에서 함수 실행 제한
modifier whenNotPaused() {
    require(!emergencyPaused, "Contract is paused");
    _;
}

// [보안] 0 address 검증
modifier validAddress(address addr) {
    require(addr != address(0), "Invalid address");
    _;
}

// [보안] 시간 순서 검증
constructor(...) Ownable(msg.sender) {
    require(_subscriptionStartTime < _subscriptionEndTime, "Invalid subscription period");
    require(_subscriptionEndTime < _paymentDueTime, "Invalid payment due time");
    require(_paymentDueTime < _allocationAnnouncementTime, "Invalid allocation time");
    ...
}

// [보안] 입력값 검증 및 1인 한도 체크
function subscribe(uint256 amount) external whenNotPaused {
    require(block.timestamp >= subscriptionStartTime, "Subscription not started");
    require(block.timestamp <= subscriptionEndTime, "Subscription ended");
    require(amount >= MIN_SUBSCRIPTION, "Below minimum subscription");
    require(amount <= MAX_SUBSCRIPTION_PER_PERSON, "Exceeds maximum subscription");
    require(investors[msg.sender].subscribedAmount + amount <= MAX_SUBSCRIPTION_PER_PERSON, "Exceeds personal limit");
    ...
}

// [보안] onlyOwner로 접근제어, 입력값 검증
function allocateTokens(address investor, uint256 amount) external onlyOwner validAddress(investor) {
    require(block.timestamp > subscriptionEndTime, "Subscription period not ended");
    require(investors[investor].subscribedAmount >= amount, "Invalid allocation amount");
    require(amount > 0, "Allocation amount must be positive");
    ...
}

// [보안] 재진입 공격 방지 (nonReentrant)
function claimDividend(uint256 dividendId) external nonReentrant whenNotPaused dividendExists(dividendId) {
    require(investors[msg.sender].hasPaid, "Not a paid investor");
    require(dividends[dividendId].isDistributed, "Dividend not distributed");
    require(investors[msg.sender].lastDividendClaim < dividendId, "Already claimed");
    ...
    (bool success, ) = payable(msg.sender).call{value: netDividend}("");
    require(success, "Dividend transfer failed");
    ...
}

// [보안] call 사용, 상태변수 먼저 변경 후 call
function withdrawFees() external onlyOwner {
    uint256 amount = totalCollectedFees;
    require(amount > 0, "No fees to withdraw");
    totalCollectedFees = 0;
    (bool success, ) = payable(owner()).call{value: amount}("");
    require(success, "Fee withdrawal failed");
}
```

---

## 3. 결론

- 기존에 알려진 주요 스마트 컨트랙트 취약점(재진입, 접근제어, 입력값 검증, 비상정지, 수수료 상한 등)에 대해 대부분 적절히 방어하고 있음
- 운영자 권한 오남용, 투자자 검증(KYC), 배당 분배 트리거 등은 추가 관리/보완 필요
- 보안 검토 결과 및 주석은 코드 내에 명확히 남겨져 있음 